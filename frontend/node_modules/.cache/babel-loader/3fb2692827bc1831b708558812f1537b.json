{"ast":null,"code":"import _objectSpread from\"C:\\\\Users\\\\WinUser\\\\PycharmProjects\\\\predictit2020\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"C:\\\\Users\\\\WinUser\\\\PycharmProjects\\\\predictit2020\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\WinUser\\\\PycharmProjects\\\\predictit2020\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:\\\\Users\\\\WinUser\\\\PycharmProjects\\\\predictit2020\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React from'react';import logo from\"./logo.svg\";import'./App.css';import{Link}from\"react-router-dom\";import USAMap from\"react-usa-map\";import ELECTORAL_VOTES from\"./electoral_votes\";import{Button,TextField}from\"@material-ui/core\";function getCookie(name){console.log(document.cookie);var cookieValue=null;if(document.cookie&&document.cookie!==''){var cookies=document.cookie.split(';');for(var i=0;i<cookies.length;i++){var cookie=cookies[i];// Does this cookie string begin with the name we want?\nif(cookie.substring(1,name.length+1)===name){cookieValue=decodeURIComponent(cookie.substring(name.length+2));break;}}}return cookieValue;}var getParamsFromURL=function getParamsFromURL(paramsStr){var parameters={};if(paramsStr)paramsStr.split(\"?\")[1].split(\"&\").forEach(function(part){var item=part.split(\"=\");parameters[item[0]]=decodeURIComponent(item[1]);});return parameters;};function App(props){var _React$useState=React.useState(0),_React$useState2=_slicedToArray(_React$useState,2),loadingStatus=_React$useState2[0],setLoadingStatus=_React$useState2[1];var _React$useState3=React.useState({}),_React$useState4=_slicedToArray(_React$useState3,2),states=_React$useState4[0],setStates=_React$useState4[1];var _React$useState5=React.useState({democrats:0,republicans:0}),_React$useState6=_slicedToArray(_React$useState5,2),electoralVotes=_React$useState6[0],setElectoralVotes=_React$useState6[1];var _React$useState7=React.useState(\"\"),_React$useState8=_slicedToArray(_React$useState7,2),saveMessage=_React$useState8[0],setSaveMessage=_React$useState8[1];var _React$useState9=React.useState(\"\"),_React$useState10=_slicedToArray(_React$useState9,2),baseUrl=_React$useState10[0],setBaseUrl=_React$useState10[1];var _React$useState11=React.useState(\"\"),_React$useState12=_slicedToArray(_React$useState11,2),shareUrl=_React$useState12[0],setShareUrl=_React$useState12[1];var _React$useState13=React.useState(false),_React$useState14=_slicedToArray(_React$useState13,2),copied=_React$useState14[0],setCopied=_React$useState14[1];var _React$useState15=React.useState(undefined),_React$useState16=_slicedToArray(_React$useState15,2),username=_React$useState16[0],setUsername=_React$useState16[1];var isFilled=Object.keys(states).length==51;var today=new Date();var canSave=today<new Date(2020,10,3);var viewId=getParamsFromURL(props.location.search)['view_id'];React.useEffect(function(){var fetchUserPrediction=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res,raw_data,base_url,json_data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(viewId){_context.next=6;break;}_context.next=3;return fetch(\"/load/\");case 3:res=_context.sent;_context.next=9;break;case 6:_context.next=8;return fetch(\"/load/?view_id=\".concat(viewId));case 8:res=_context.sent;case 9:if(!(res.status===403)){_context.next=13;break;}setLoadingStatus(2);_context.next=31;break;case 13:_context.next=15;return res.json();case 15:raw_data=_context.sent;base_url=raw_data.base_url;setBaseUrl(base_url);json_data=JSON.parse(raw_data.prediction);setShareUrl(\"\".concat(base_url,\"/static/build/index.html?view_id=\").concat(json_data.id));setUsername(raw_data.username);delete json_data.number_correct;delete json_data.id;delete json_data.user;json_data.ID=json_data.IDA;delete json_data.IDA;setElectoralVotes({democrats:json_data.electoral_votes_dem,republicans:json_data.electoral_votes_rep});delete json_data.electoral_votes_dem;delete json_data.electoral_votes_rep;setStates(json_data);setLoadingStatus(1);case 31:case\"end\":return _context.stop();}}},_callee);}));return function fetchUserPrediction(){return _ref.apply(this,arguments);};}();fetchUserPrediction();},[]);var mapHandler=function mapHandler(event){if(!viewId){setSaveMessage(\"\");var stateId=event.target.dataset.name=='DC'?'DC2':event.target.dataset.name;var newStates=JSON.parse(JSON.stringify(states));if(stateId in newStates){if(newStates[stateId].fill==='navy'){newStates[stateId].fill='red';setElectoralVotes({democrats:electoralVotes.democrats-ELECTORAL_VOTES[stateId],republicans:electoralVotes.republicans+ELECTORAL_VOTES[stateId]});}else{newStates[stateId].fill='navy';setElectoralVotes({democrats:electoralVotes.democrats+ELECTORAL_VOTES[stateId],republicans:electoralVotes.republicans-ELECTORAL_VOTES[stateId]});}}else{newStates[stateId]={'fill':'navy'};setElectoralVotes(_objectSpread(_objectSpread({},electoralVotes),{},{democrats:electoralVotes.democrats+ELECTORAL_VOTES[stateId]}));}setStates(newStates);}};return/*#__PURE__*/React.createElement(\"div\",{className:\"App\"},loadingStatus===0?\"Loading\":loadingStatus===2?\"Not Logged in properly, or invalid ID, unable to load\":loadingStatus===1&&/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{style:{position:\"relative\",marginTop:'50px'}},/*#__PURE__*/React.createElement(\"div\",{style:{position:\"absolute\",left:\"0px\",top:\"10px\",height:'40px',width:\"\".concat(electoralVotes.republicans/538*100,\"%\"),background:\"red\"}}),/*#__PURE__*/React.createElement(\"div\",{style:{position:\"absolute\",right:\"0px\",top:\"10px\",height:'40px',width:\"\".concat(electoralVotes.democrats/538*100,\"%\"),background:\"navy\"}}),/*#__PURE__*/React.createElement(\"div\",{style:{position:\"absolute\",left:\"5%\",top:\"0px\",color:'#999'}},/*#__PURE__*/React.createElement(\"h3\",null,\"Republicans: \",electoralVotes.republicans)),/*#__PURE__*/React.createElement(\"div\",{style:{position:\"absolute\",right:\"5%\",top:\"0px\",color:'#999'}},/*#__PURE__*/React.createElement(\"h3\",null,\"Democrats: \",electoralVotes.democrats)),viewId!==undefined&&/*#__PURE__*/React.createElement(\"div\",{style:{paddingTop:'100px'}},/*#__PURE__*/React.createElement(\"h1\",null,username,\"'s map\")),/*#__PURE__*/React.createElement(\"div\",{style:{paddingTop:'100px'}},/*#__PURE__*/React.createElement(USAMap,{customize:states,onClick:mapHandler}))),canSave?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",null,viewId===undefined&&/*#__PURE__*/React.createElement(Button,{onClick:/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(ev){var csrf_token,res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:csrf_token=getCookie(\"csrftoken\");console.log(csrf_token);_context2.next=4;return fetch(\"/save/\",{method:'POST',mode:'cors',headers:{'X-CSRFToken':csrf_token,'Content-Type':'application/json'},body:JSON.stringify({states:states,electoralVotes:electoralVotes})});case 4:res=_context2.sent;if(res.status===200)setSaveMessage(\"Saved! You're all set! (You can modify it until November 3rd)\");else setSaveMessage(\"Did not save properly!  Please try clicking save again\");case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x){return _ref2.apply(this,arguments);};}(),variant:\"contained\",disabled:!isFilled,color:\"primary\",style:{marginTop:'50px'}},isFilled?\"Save My Prediction\":\"Not Finished\")),viewId===undefined&&/*#__PURE__*/React.createElement(\"div\",{style:{marginTop:'50px'}},/*#__PURE__*/React.createElement(\"p\",null,\"Share Link\"),/*#__PURE__*/React.createElement(TextField,{value:shareUrl,style:{width:'75%'},onClick:function onClick(ev){ev.target.select();document.execCommand('copy');setCopied(true);setTimeout(function(){setCopied(false);},1500);}})),viewId===undefined&&/*#__PURE__*/React.createElement(\"p\",{style:{paddingBottom:'200px'}},copied?\"Copied!\":\"Click to copy to Clipboard\"),viewId!==undefined&&canSave&&/*#__PURE__*/React.createElement(\"div\",{style:{marginTop:'50px'}},\"This is \",username,\"'s prediction for the 2020 election, what's yours?  Give it a try yourself here!\",/*#__PURE__*/React.createElement(\"div\",{style:{paddingBottom:'200px'}},/*#__PURE__*/React.createElement(Link,{to:\"//\".concat(baseUrl),target:\"_blank\"},\"Predict the Election\")))):viewId===undefined&&/*#__PURE__*/React.createElement(\"p\",null,\"It is November 3rd (Or after) and you can't update your prediction anymore.\"),/*#__PURE__*/React.createElement(\"p\",null,saveMessage)));}export default App;","map":{"version":3,"sources":["C:/Users/WinUser/PycharmProjects/predictit2020/frontend/src/App.js"],"names":["React","Link","USAMap","ELECTORAL_VOTES","Button","TextField","getCookie","name","console","log","document","cookie","cookieValue","cookies","split","i","length","substring","decodeURIComponent","getParamsFromURL","paramsStr","parameters","forEach","part","item","App","props","useState","loadingStatus","setLoadingStatus","states","setStates","democrats","republicans","electoralVotes","setElectoralVotes","saveMessage","setSaveMessage","baseUrl","setBaseUrl","shareUrl","setShareUrl","copied","setCopied","undefined","username","setUsername","isFilled","Object","keys","today","Date","canSave","viewId","location","search","useEffect","fetchUserPrediction","fetch","res","status","json","raw_data","base_url","json_data","JSON","parse","prediction","id","number_correct","user","ID","IDA","electoral_votes_dem","electoral_votes_rep","mapHandler","event","stateId","target","dataset","newStates","stringify","fill","position","marginTop","left","top","height","width","background","right","color","paddingTop","ev","csrf_token","method","mode","headers","body","select","execCommand","setTimeout","paddingBottom"],"mappings":"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","sourcesContent":["import React from 'react';\nimport logo from './logo.svg';\nimport './App.css';\n\nimport {Link} from \"react-router-dom\"\n\nimport USAMap from \"react-usa-map\";\n\nimport ELECTORAL_VOTES from \"./electoral_votes\"\n\nimport {Button, TextField} from \"@material-ui/core\"\n\nfunction getCookie(name) {\n    console.log(document.cookie)\n    var cookieValue = null;\n    if (document.cookie && document.cookie !== '') {\n        var cookies = document.cookie.split(';');\n        for (var i = 0; i < cookies.length; i++) {\n            var cookie = cookies[i]\n            // Does this cookie string begin with the name we want?\n            if (cookie.substring(1, name.length + 1) === name) {\n                cookieValue = decodeURIComponent(cookie.substring(name.length + 2));\n                break;\n            }\n        }\n    }\n    return cookieValue;\n}\n\nconst getParamsFromURL = (paramsStr) => {\n    let parameters = {}\n\n    if(paramsStr) paramsStr.split(\"?\")[1].split(\"&\").forEach(part => {\n        let item = part.split(\"=\")\n        parameters[item[0]] = decodeURIComponent(item[1])\n    })\n\n    return parameters\n\n}\n\n\n\nfunction App(props) {\n\n    const [loadingStatus, setLoadingStatus] = React.useState(0)\n    const [states, setStates] = React.useState({})\n    const [electoralVotes, setElectoralVotes] = React.useState({\n        democrats: 0,\n        republicans: 0,\n    })\n    const [saveMessage, setSaveMessage] = React.useState(\"\")\n    const [baseUrl, setBaseUrl] = React.useState(\"\")\n    const [shareUrl, setShareUrl] = React.useState(\"\")\n    const [copied, setCopied] = React.useState(false)\n    const [username, setUsername] = React.useState(undefined)\n\n  const isFilled = Object.keys(states).length == 51\n\n  const today = new Date()\n  const canSave = today < new Date(2020, 10, 3)\n\n  const viewId = getParamsFromURL(props.location.search)['view_id']\n\n  React.useEffect(() => {\n    const fetchUserPrediction = async () => {\n        let res\n        if(!viewId) res = await fetch(`/load/`)\n        else res = await fetch(`/load/?view_id=${viewId}`)\n        if(res.status === 403) setLoadingStatus(2)\n        else {\n            const raw_data = await res.json()\n            const base_url = raw_data.base_url\n            setBaseUrl(base_url)\n            let json_data = JSON.parse(raw_data.prediction)\n            setShareUrl(`${base_url}/static/build/index.html?view_id=${json_data.id}`)\n\n            setUsername(raw_data.username)\n            delete json_data.number_correct\n            delete json_data.id\n            delete json_data.user\n            json_data.ID = json_data.IDA\n            delete json_data.IDA\n            setElectoralVotes({democrats: json_data.electoral_votes_dem, republicans: json_data.electoral_votes_rep})\n            delete json_data.electoral_votes_dem\n            delete json_data.electoral_votes_rep\n            setStates(json_data)\n            setLoadingStatus(1)\n        }\n    }\n\n    fetchUserPrediction()\n  }, [])\n\n  const mapHandler = (event) => {\n    if(!viewId){\n        setSaveMessage(\"\")\n        const stateId = event.target.dataset.name == 'DC' ? 'DC2' : event.target.dataset.name\n        let newStates = JSON.parse(JSON.stringify(states))\n        if (stateId in newStates) {\n            if(newStates[stateId].fill === 'navy') {\n                newStates[stateId].fill = 'red'\n                setElectoralVotes({\n                    democrats: electoralVotes.democrats - ELECTORAL_VOTES[stateId],\n                    republicans: electoralVotes.republicans + ELECTORAL_VOTES[stateId],\n                })\n            }\n            else {\n                newStates[stateId].fill = 'navy'\n                setElectoralVotes({\n                    democrats: electoralVotes.democrats + ELECTORAL_VOTES[stateId],\n                    republicans: electoralVotes.republicans - ELECTORAL_VOTES[stateId],\n                })\n            }\n        } else {\n            newStates[stateId] = {'fill': 'navy'}\n            setElectoralVotes({...electoralVotes, democrats: electoralVotes.democrats + ELECTORAL_VOTES[stateId]})\n        }\n        setStates(newStates)\n    }\n  };\n  return (\n    <div className=\"App\">\n        {loadingStatus === 0 ? \"Loading\" : loadingStatus === 2 ? \"Not Logged in properly, or invalid ID, unable to load\" : loadingStatus === 1 && (\n            <>\n                <div style={{position: \"relative\", marginTop: '50px'}}>\n                    <div style={{position: \"absolute\", left: \"0px\" , top:\"10px\", height: '40px', width: `${electoralVotes.republicans / 538 * 100}%` , background: \"red\"}}></div>\n                    <div style={{position: \"absolute\", right: \"0px\" , top:\"10px\", height: '40px', width: `${electoralVotes.democrats / 538 * 100}%` , background: \"navy\"}}></div>\n                    <div style={{position: \"absolute\", left:\"5%\", top:\"0px\", color: '#999' }}>\n                        <h3>Republicans: {electoralVotes.republicans}</h3>\n                    </div>\n\n                    <div style={{position: \"absolute\", right:\"5%\", top:\"0px\", color: '#999'}}>\n                        <h3>Democrats: {electoralVotes.democrats}</h3>\n                    </div>\n                    {viewId !== undefined && (\n                    <div style={{paddingTop: '100px'}}>\n                        <h1>{username}'s map</h1>\n                    </div>\n                    )}\n                    <div style={{paddingTop: '100px'}}>\n                        <USAMap customize={states} onClick={mapHandler}  />\n                    </div>\n                </div>\n                {canSave ? (\n                    <>\n                        <div>\n                            {viewId === undefined && <Button\n                                onClick={async ev => {\n                                    const csrf_token = getCookie(\"csrftoken\")\n                                    console.log(csrf_token)\n\n                                    const res = await fetch(`/save/`, {\n                                        method: 'POST',\n                                        mode: 'cors',\n                                        headers: {\n                                            'X-CSRFToken': csrf_token,\n                                            'Content-Type': 'application/json',\n                                        },\n                                        body: JSON.stringify({states: states, electoralVotes: electoralVotes})\n                                    })\n                                    if(res.status === 200) setSaveMessage(\"Saved! You're all set! (You can modify it until November 3rd)\")\n                                    else setSaveMessage(\"Did not save properly!  Please try clicking save again\")\n                                }}\n                                variant=\"contained\" disabled={!isFilled} color=\"primary\" style={{marginTop: '50px'}}>\n                                {isFilled ? \"Save My Prediction\" : \"Not Finished\"}\n                            </Button>}\n                        </div>\n                        {viewId === undefined && <div style={{marginTop: '50px'}}>\n                           <p>Share Link</p>\n                           <TextField\n                            value={shareUrl}\n                            style={{width: '75%'}}\n                            onClick={ev => {\n                                ev.target.select()\n                                document.execCommand('copy')\n                                setCopied(true)\n                                setTimeout(()=> {\n                                    setCopied(false)\n                                }, 1500)\n                            }}\n                           />\n                        </div>}\n                        {viewId === undefined && <p style={{paddingBottom: '200px'}}>{copied ? \"Copied!\" : \"Click to copy to Clipboard\"}</p>}\n                        {viewId !== undefined && canSave && <div style={{marginTop: '50px'}}>\n                            This is {username}'s prediction for the 2020 election, what's yours?  Give it a try yourself here!\n                            <div style={{paddingBottom: '200px'}}>\n                                <Link to={`//${baseUrl}`} target=\"_blank\">\n                                    Predict the Election\n                                </Link>\n                            </div>\n                        </div>}\n                    </>\n                ) : (\n                    viewId === undefined && <p>It is November 3rd (Or after) and you can't update your prediction anymore.</p>\n                )}\n\n                <p>{saveMessage}</p>\n            </>\n        )}\n\n\n    </div>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}